## WITH RECURSIVE (ì¬ê·€ ì¿¼ë¦¬)

ê³ ê°ì‚¬ ìš”ì²­ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë½‘ëŠ”ë° í•˜ìœ„ì— í¬í•¨ëœ ì• ë“¤ë„ í•œ ì–‘ì‹ìœ¼ë¡œ ë½‘ê³  ì‹¶ì–´í•¨.
ì¼ì¼íˆ ì„œë¸Œì¿¼ë¦¬ë¡œ ì‘ì„±í•˜ë ¤ë‹¤ê°€ í˜¹ì‹œ ì´ìœ¼ë ¤ë‚˜ í•´ì„œ ê²€ìƒ‰í•´ë´¤ë‹¤ê°€ ì²˜ìŒ ì•Œê²Œ ë˜ì—ˆë‹¤.

### ì‚¬ìš© ì¡°ê±´ 
0. ë©”ëª¨ë¦¬ ìƒì— ê°€ìƒì˜ í…Œì´ë¸”ì„ ì €ì¥
1. WITH RECURSIVE ëª…ë ¹ì–´ ë‚´ë¶€ì— ì‘ì„±
2. ë°˜ë“œì‹œ UNIONì„ ì‚¬ìš©í•´ì•¼í•¨
3. Non-Recursive ë¬¸ë„ ìµœì†Œ 1ê°œ í•„ìš” 
4. SubQueryì—ì„œÂ ë°”ê¹¥ì˜ ê°€ìƒì˜ í…Œì´ë¸”ì„ ì°¸ì¡°í•˜ëŠ” ë¬¸ì¥(ë°˜ë³µë¬¸)ì´ ë°˜ë“œì‹œ í•„ìš” -> ..
5. ë°˜ë³µë˜ëŠ” ë¬¸ì¥ì€ ë°˜ë“œì‹œÂ ì •ì§€ì¡°ê±´ ìš”êµ¬
6. ê°€ìƒì˜ í…Œì´ë¸”ì„ êµ¬ì„±í•˜ë©´ì„œ ê·¸ ìì‹ (ê°€ìƒì˜ í…Œì´ë¸”)ì„ ì°¸ì¡°í•˜ì—¬ ê°’ì„ ê²°ì •í•  ë•Œ ìœ ìš©

ì¼ì¼íˆ ì„œë¸Œì¿¼ë¦¬ ë° ì¡°ì¸ìœ¼ë¡œ ë‚œë¦¬ ì¹  í•„ìš”ê°€ ì—†ì—ˆë‹¤..!
ê·¸ë™ì•ˆ mysql 5.8 ì“°ë‹¤ê°€ ì´ë²ˆì— mysql 8.xë¡œ ì—…ê·¸ë ˆì´ë“œ ë˜ë©´ì„œ ì´ëŸ° ì‹ ê¸°ëŠ¥ì„ ì“¸ ìˆ˜ ìˆì–´ì„œ ì‚¶ì˜ ì§ˆì´ í–¥ìƒë˜ëŠ” ê¸°ë¶„ì´ë‹¤.
ê·¼ë° ë­ ì¼ì€ .. ã… 


ì§ì¥ë™ë£Œê°€ ì‘ì„±í•œ ì¿¼ë¦¬ ğŸ˜Š
```sql
with recursive workflow_rule (task_workflow_id,workflow_rule_id, workflow_rule_parent_id, level,task_rule_id) as (
   select 
      task_workflow_id,
      workflow_rule_id,
      workflow_rule_parent_id,
      0 as level,
      task_rule_id
   from bc_task_workflow_rule T1
   where workflow_rule_parent_id is null or workflow_rule_parent_id = 0
   union all   
   select 
      T1.task_workflow_id,
      T1.workflow_rule_id,
      T1.workflow_rule_parent_id,
      T2.level + 1,
      T1.task_rule_id
   from bc_task_workflow_rule T1
   join workflow_rule T2 on T1.workflow_rule_parent_id = T2.workflow_rule_id
),
workflow_data as (
   select 
      T2.user_task_name,
      T1.task_rule_id,
      T1.workflow_rule_parent_id,
      T1.level,
      concat(repeat(' | ',T1.level), T3.job_name) as job_name,
      T1.task_workflow_id,
      T1.workflow_rule_id
   from workflow_rule T1
   join bc_task_workflow T2 on T1.task_workflow_id = T2.task_workflow_id 
   left join bc_task_rule T3 on T1.task_rule_id = T3.task_rule_id 
),
empty_rows as (
   select 
      user_task_name,
      NULL as task_rule_id,
      NULL as workflow_rule_parent_id,
      NULL as level,
      '' as job_name,
      task_workflow_id,
      -1 as workflow_rule_id -- ì •ë ¬ì„ ìœ„í•œ ë”ë¯¸ê°’
   from workflow_data
   group by user_task_name, task_workflow_id
)
select * 
from (
   select 
      T2.user_task_name,
      '' as level,
      '' as job_name,
      T1.register,
      T1.description,
        CASE T1.ACTIVITY
            WHEN 1 THEN 'on'
            ELSE 'off'
         END AS "í™œì„±í™”",
       T1.preset_type,
      T2.task_workflow_id,
      T2.workflow_rule_id,
      '' as type
   from bc_task_workflow T1
   join empty_rows T2 on T1.task_workflow_id = T2.task_workflow_id
   where T1.type = 'i'
   union all
   select 
      '' as user_task_name,
      T2.level + 1,
      T2.job_name,
      '' as register,
      '' as description,
      '' as active,
      '' as preset_type,
      T2.task_workflow_id,
      T2.workflow_rule_id,
      T1.type
   from bc_task_workflow T1
   join workflow_data T2 on T1.task_workflow_id = T2.task_workflow_id
   where T1.type = 'i'
) as T1
order by T1.task_workflow_id, T1.workflow_rule_id;
```


ì¶œì²˜ : https://inpa.tistory.com/entry/MYSQL-%F0%9F%93%9A-RECURSIVE-%EC%9E%AC%EA%B7%80-%EC%BF%BC%EB%A6%AC